---
import { ImageOutputFormat } from "astro";
import { getImage } from "astro:assets";

export interface Props {
    // TODO: consider supporting strings for remote/single-file favicons with a fixed size
    src: ImageMetadata;
}

const { src } = Astro.props;

const image = (size: number, format: ImageOutputFormat) =>
    getImage({ src, format, width: size, height: size }).then((x) => x.src);
---

{
    await Promise.all(
        [196, 160, 96, 64, 32, 16].map(async (size) => (
            <link
                rel="icon"
                type="image/png"
                sizes={size + "x" + size}
                href={await image(size, "png")}
            />
        )),
    )
}
{
    await Promise.all(
        [57, 114, 72, 144, 60, 120, 76, 152, 180].map(async (size) => (
            <link
                rel="apple-touch-icon"
                type="image/png"
                sizes={size + "x" + size}
                href={await image(size, "png")}
            />
        )),
    )
}
<meta name="msapplication-TileImage" content={await image(144, "png")} />
